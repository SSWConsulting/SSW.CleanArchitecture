{"pageProps":{"projectName":"SSW Clean Architecture Template","currentAdr":{"slug":"20230604-use-the-factory-pattern-to-create-aggregates","package":null,"title":"Use the Factory Pattern to Create Aggregates","status":"accepted","supersededBy":null,"tags":["ef-core","domain"],"deciders":["Daniel Mackay","William Libenberg","Matt Goldman","Luke Parker","Chris Clements"],"body":{"enhancedMdx":"\nTechnical Story: [SSW.CleanArchitecture | Issues | 111](https://github.com/SSWConsulting/SSW.CleanArchitecture/issues/111)\n\n## Context and Problem Statement\n\nAggregate roots can be instantiated in a way that satisfies all the decision drivers.  What is the best way to create aggregates?\n\n## Decision Drivers\n\n- Must work well with EF Core\n- Must be able to raise domain events on object creation\n- Must keep aggregate roots in a valid state at all times\n\n## Considered Options\n\n1. Factory Methods\n2. Constructors\n3. `required init` properties\n\n## Decision Outcome\n\nChosen **Option 1. Factory Methods**, because it is the only option that meets all the decision drivers.\n\n## Consequences\n\n- Private constructors can be used to ensure that aggregates are always in a valid state\n- Need to use `null!` to remove nullable warnings\n\n## Pros and Cons of the Options\n\n### 1. Factory Methods\n\n- ✅ EF Core can still create the aggregate when hydrating data from the DB\n- ✅ Domain events can be raised when aggregates are created via the application, but not when they are hydrated from the DB\n- ✅ Provides a consistent way to create aggregates\n- ✅ Aggregates remain encapsulated\n\n### 2. Constructors\n\n- ❌ EF will incorrectly raise domain events when hydrating data from the DB\n- ❌ EF does not allow owned entities to be passed to constructors\n\n### 3. `required init` properties\n\n- ❌ Properties need to be passed to constructors to ensure they are in a valid state on object creation.  Can't use `required init` properties as they then become unmodifiable\n"},"creationDate":"2023-06-15T01:49:58.000Z","lastEditDate":"2023-06-15T01:49:58.000Z","lastEditAuthor":"Daniel Mackay [SSW]","publicationDate":null,"file":{"relativePath":"docs/adr/20230604-use-the-factory-pattern-to-create-aggregates.md","absolutePath":"/home/runner/work/SSW.CleanArchitecture/SSW.CleanArchitecture/docs/adr/20230604-use-the-factory-pattern-to-create-aggregates.md"},"repository":{"provider":"github","viewUrl":"https://github.com/SSWConsulting/SSW.CleanArchitecture/blob/master/docs/adr/20230604-use-the-factory-pattern-to-create-aggregates.md"}},"l4bVersion":"1.1.0"},"__N_SSG":true}